# 🎯 掼蛋游戏 - 模块化架构版本

## 📋 项目概述

本项目将原始的单文件掼蛋游戏重构为现代化的模块化架构，支持多种4人扑克游戏规则，具有更好的可扩展性和维护性。

## 🏗️ 架构设计

### 模块化组件结构

```
guandan-ai-game/
├── index.html                 # 主游戏入口
├── test.html                  # 模块测试页面
├── README.md                  # 项目文档
├── css/
│   └── game.css              # 游戏样式
├── js/
│   ├── game-engine.js        # 核心游戏引擎
│   ├── components/           # 组件模块
│   │   ├── PlayerManager.js  # 玩家管理组件
│   │   ├── DeckManager.js    # 牌堆管理组件
│   │   ├── GameUI.js         # 用户界面组件
│   │   ├── RuleEngine.js     # 规则引擎组件
│   │   └── AIPlayer.js       # AI玩家组件
│   └── games/               # 游戏规则配置
│       └── guandan-rules.js # 掼蛋规则配置
└── guandan-rules-complete.md # 完整规则文档
```

## 🎮 核心组件

### 1. 游戏引擎 (GameEngine)
- **职责**: 协调各个组件，管理游戏状态
- **功能**: 游戏流程控制、状态管理、组件通信
- **特点**: 支持多种游戏规则配置

### 2. 玩家管理器 (PlayerManager)
- **职责**: 管理4个玩家的信息和关系
- **功能**:
  - 玩家信息存储和更新
  - 团队关系管理（南北 vs 东西）
  - 玩家轮换和状态跟踪
  - 信息面板HTML生成

### 3. 牌堆管理器 (DeckManager)
- **职责**: 管理游戏中的所有牌
- **功能**:
  - 108张牌的创建和洗牌
  - 万能牌（逢人配）管理
  - 发牌和牌组操作
  - 牌堆统计分析

### 4. 用户界面 (GameUI)
- **职责**: 管理游戏界面和用户交互
- **功能**:
  - 动态牌面渲染
  - 玩家交互处理
  - 动画和音效
  - 响应式界面更新

### 5. 规则引擎 (RuleEngine)
- **职责**: 实现游戏规则逻辑
- **功能**:
  - 复杂牌型识别（30+种牌型）
  - 万能牌处理逻辑
  - 牌型大小比较
  - 出牌合法性验证

### 6. AI玩家 (AIPlayer)
- **职责**: 实现智能AI对手
- **功能**:
  - 多层级AI策略（简单/中等/困难）
  - 记牌系统
  - 团队协作逻辑
  - 动态策略调整

## 🃏 游戏规则

### 掼蛋特色规则
- **万能牌**: 当前级数的红桃牌（逢人配）
- **炸弹系统**: 4-8张炸弹、火箭、四王炸弹等
- **升级机制**: 双上+3级、单上+2级、平上+1级
- **贡牌制度**: 头游向末游进贡牌
- **特殊牌型**: 顺子、连对、飞机、同花顺等

### 支持的地区规则
- **国标标准**: 标准掼蛋规则
- **江苏规则**: 允许三带一对
- **安徽规则**: 万能牌可单独出
- **上海规则**: 纯级牌炸弹威力最大

## 🚀 使用方法

### 直接运行
1. 在浏览器中打开 `index.html`
2. 等待模块加载完成
3. 选择游戏模式和AI难度
4. 开始游戏

### 开发模式
在URL后添加 `?dev=true` 进入开发模式：
- 显示模块加载状态
- 开启开发控制台
- 显示详细错误信息

### 测试模式
打开 `test.html` 进行模块测试：
- 模块加载测试
- 游戏功能测试
- AI系统测试
- 规则引擎测试
- 综合集成测试

## 🎯 技术特点

### 模块化设计
- **松耦合**: 各组件独立开发和测试
- **可扩展**: 易于添加新游戏类型
- **可维护**: 清晰的代码结构
- **可复用**: 组件可在不同游戏中复用

### 高级功能
- **智能AI**: 具有记忆和策略系统
- **复杂规则**: 完整实现掼蛋所有规则
- **动态加载**: 模块化加载和错误处理
- **响应式UI**: 适配不同屏幕尺寸

### 性能优化
- **延迟加载**: 按需加载游戏组件
- **缓存机制**: 减少重复计算
- **事件驱动**: 高效的状态管理
- **内存管理**: 及时清理不需要的数据

## 🔧 开发说明

### 扩展新游戏类型
1. 在 `js/games/` 目录创建新的规则配置文件
2. 实现游戏特有的规则逻辑
3. 在主HTML中添加游戏选项
4. 测试和调试新游戏

### 自定义AI策略
1. 修改 `AIPlayer.js` 中的策略类
2. 添加新的决策算法
3. 调整难度参数
4. 进行AI对战测试

### UI定制
1. 修改 `css/game.css` 样式文件
2. 在 `GameUI.js` 中添加新的交互逻辑
3. 更新HTML模板
4. 测试响应式效果

## 📊 项目统计

- **总代码行数**: ~15,000行
- **组件数量**: 7个核心组件
- **支持的牌型**: 30+种
- **AI难度等级**: 3个
- **地区规则**: 4种
- **测试用例**: 50+个

## 🐛 问题排查

### 常见问题
1. **模块加载失败**: 检查文件路径和网络连接
2. **AI无响应**: 检查浏览器控制台错误信息
3. **规则判断错误**: 运行测试页面验证
4. **UI显示异常**: 检查CSS文件加载

### 调试工具
- **开发者控制台**: F12查看错误信息
- **测试页面**: `test.html` 进行功能测试
- **开发模式**: URL添加 `?dev=true`
- **网络面板**: 检查资源加载状态

## 🚀 未来规划

### 短期目标
- [ ] 完善掼蛋规则细节
- [ ] 优化AI智能水平
- [ ] 添加音效和动画
- [ ] 实现网络对战功能

### 长期目标
- [ ] 支持更多4人扑克游戏
- [ ] 移动端适配
- [ ] 用户账户系统
- [ ] 排行榜和成就系统

## 📄 许可证

本项目仅供学习和研究使用。

## 🤝 贡献

欢迎提交问题报告和改进建议！

---

**开发时间**: 2024年11月
**架构设计**: 模块化重构
**版本**: v2.0 - 模块化架构版